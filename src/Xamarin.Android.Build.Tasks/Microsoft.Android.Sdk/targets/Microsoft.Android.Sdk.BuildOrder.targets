<!--
***********************************************************************************************
Microsoft.Android.Sdk.BuildOrder.targets

This file contains the .NET 5-specific setup for any $(FooDependsOn)
properties that determine build ordering. For "legacy" Xamarin.Android
projects, these properties are set in Xamarin.Android.Legacy.targets.

***********************************************************************************************
-->

<Project xmlns="http://schemas.microsoft.com/developer/msbuild/2003">

  <PropertyGroup Condition=" '$(AndroidApplication)' == 'True' ">
    <BuildDependsOn>
      _ValidateLinkMode;
      _CheckNonIdealConfigurations;
      _SetupMSBuildAllProjects;
      _SetupDesignTimeBuildForBuild;
      _CategorizeAndroidLibraries;
      _CreatePropertiesCache;
      _CleanIntermediateIfNeeded;
      _CheckProjectItems;
      _CheckForContent;
      _ValidateAndroidPackageProperties;
      AddLibraryJarsToBind;
      $(BuildDependsOn);
      _CompileDex;
      $(_AfterCompileDex);
      _CopyPackage;
      _Sign;
    </BuildDependsOn>
    <_BeforeIncrementalClean>
      _PrepareAssemblies;
      _CompileDex;
      $(_AfterCompileDex);
      _AddFilesToFileWrites;
    </_BeforeIncrementalClean>
    <_PackageForAndroidDependsOn>
      Build;
      _CopyPackage;
    </_PackageForAndroidDependsOn>
    <_PrepareBuildApkDependsOnTargets>
      _SetLatestTargetFrameworkVersion;
      _GetLibraryImports;
      _RemoveRegisterAttribute;
      _ResolveAssemblies;
      _ResolveSatellitePaths;
      _CreatePackageWorkspace;
      _LinkAssemblies;
      _GenerateJavaStubs;
      _ManifestMerger;
      _ConvertCustomView;
      $(_AfterConvertCustomView);
      $(AfterGenerateAndroidManifest);
      _GenerateEnvironmentFiles;
      _CompileJava;
      _CreateApplicationSharedLibraries;
      _CompileDex;
      $(_AfterCompileDex);
      _CreateBaseApk;
      _PrepareAssemblies;
      _ResolveSatellitePaths;
      _CheckApkPerAbiFlag;
      _LintChecks;
      _IncludeNativeSystemLibraries;
      _CheckGoogleSdkRequirements;
    </_PrepareBuildApkDependsOnTargets>
  </PropertyGroup>

  <PropertyGroup Condition=" '$(AndroidApplication)' != 'True' ">
    <BuildDependsOn>
      _ValidateLinkMode;
      _SetupMSBuildAllProjects;
      _SetupDesignTimeBuildForBuild;
      _CategorizeAndroidLibraries;
      _CreatePropertiesCache;
      _CleanIntermediateIfNeeded;
      _AddAndroidDefines;
      _CheckForContent;
      _RemoveLegacyDesigner;
      _ValidateAndroidPackageProperties;
      AddLibraryJarsToBind;
      $(BuildDependsOn);
    </BuildDependsOn>
    <_BeforeIncrementalClean>
      _AddFilesToFileWrites;
    </_BeforeIncrementalClean>
  </PropertyGroup>

  <!-- Targets that run unless we are running _ComputeFilesToPublishForRuntimeIdentifiers -->
  <PropertyGroup Condition=" '$(_ComputeFilesToPublishForRuntimeIdentifiers)' != 'true' ">
    <CoreResolveReferencesDependsOn>
      _SeparateAppExtensionReferences;
      $(ResolveReferencesDependsOn);
      _AddAndroidCustomMetaData;
      _ResolveAars;
    </CoreResolveReferencesDependsOn>
    <ResolveReferencesDependsOn>
      $(CoreResolveReferencesDependsOn);
      UpdateAndroidInterfaceProxies;
      UpdateAndroidResources;
      AddBindingsToCompile;
    </ResolveReferencesDependsOn>
    <_UpdateAndroidResourcesDependsOn>
      $(CoreResolveReferencesDependsOn);
      _CreatePropertiesCache;
      _CheckForDeletedResourceFile;
      _ComputeAndroidResourcePaths;
      _UpdateAndroidResgen;
      _CreateAar;
    </_UpdateAndroidResourcesDependsOn>
  </PropertyGroup>

  <PropertyGroup>
    <CoreBuildDependsOn>
      $([MSBuild]::Unescape($(CoreBuildDependsOn.Replace('IncrementalClean;', '$(_BeforeIncrementalClean);IncrementalClean;'))))
    </CoreBuildDependsOn>
    <CompileDependsOn>
      _SetupMSBuildAllProjects;
      _SetupDesignTimeBuildForCompile;
      _AddAndroidDefines;
      _IncludeLayoutBindingSources;
      AddLibraryJarsToBind;
      $(CompileDependsOn);
    </CompileDependsOn>
    <CoreCompileDependsOn>
      UpdateGeneratedFiles;
      $(CoreCompileDependsOn)
    </CoreCompileDependsOn>
    <DeferredBuildDependsOn>
      $(DeferredBuildDependsOn);
      UpdateAndroidResources;
    </DeferredBuildDependsOn>
    <PrepareForRunDependsOn>
      $(PrepareForRunDependsOn);
      _CollectMonoAndroidOutputs;
    </PrepareForRunDependsOn>
    <CleanDependsOn>
      $(CleanDependsOn);
      _CleanMonoAndroidIntermediateDir;
      _CleanAndroidBuildPropertiesCache;
      CleanBindingsOutput;
      CleanLibraryProjectIntermediaries;
      CleanNativeLibraryIntermediaries;
    </CleanDependsOn>
    <ExportJarToXmlDependsOnTargets>
      _ResolveMonoAndroidSdks;
      _ExtractLibraryProjectImports;
      _GetLibraryImports;
      _ExtractAar;
      _ExportJarToXml;
    </ExportJarToXmlDependsOnTargets>
    <GetAndroidDependenciesDependsOn>
      _BeforeGetAndroidDependencies;
      _SetLatestTargetFrameworkVersion;
      _ResolveSdks;
      _ResolveAndroidTooling;
      $(GetAndroidDependenciesDependsOn);
    </GetAndroidDependenciesDependsOn>
    <_ResolveLibraryProjectsDependsOn>
      _ExtractAar;
    </_ResolveLibraryProjectsDependsOn>
  </PropertyGroup>

</Project>
