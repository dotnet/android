<?xml version="1.0" encoding="UTF-8" ?>
<Project xmlns="http://schemas.microsoft.com/developer/msbuild/2003">
  <UsingTask TaskName="Xamarin.Android.Tools.BootstrapTasks.GenerateProfile" AssemblyFile="..\..\bin\Build$(Configuration)\Xamarin.Android.Tools.BootstrapTasks.dll" />
  <ItemGroup>
    <SharedRuntimeBuildPath Include="..\..\bin\$(Configuration)\lib\xbuild-frameworks\MonoAndroid\" />
    <_SharedRuntimeAssemblies Include="@(SharedRuntimeBuildPath->'%(Identity)\\v1.0\*.dll');@(SharedRuntimeBuildPath->'%(Identity)\\v6.0\*.dll')"/>
  </ItemGroup>

  <Target Name="_Foo" BeforeTargets="CoreCompile"
	  Inputs="@(_SharedRuntimeAssemblies)"
	  Outputs="$(_GeneratedProfileClass)"
	  >
    <PropertyGroup>
       <_GeneratedProfileClass>$(IntermediateOutputPath)Profile.g.cs</_GeneratedProfileClass>
    </PropertyGroup>
    <GenerateProfile Files="@(_SharedRuntimeAssemblies)" OutputFile="$(_GeneratedProfileClass)" />
    <ItemGroup>
        <Compile Include="$(_GeneratedProfileClass)" />
    </ItemGroup>
    <WriteLinesToFile
        File="$(IntermediateOutputPath)$(CleanFile)"
        Lines="$(_GeneratedProfileClass)"
        Overwrite="false"/>
  </Target>
</Project>