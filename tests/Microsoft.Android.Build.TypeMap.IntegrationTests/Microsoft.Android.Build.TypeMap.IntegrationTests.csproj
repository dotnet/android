<Project Sdk="Microsoft.NET.Sdk">

  <PropertyGroup>
    <TargetFramework>$(DotNetStableTargetFramework)</TargetFramework>
    <LangVersion>latest</LangVersion>
    <Nullable>enable</Nullable>
    <IsPackable>false</IsPackable>
    <RootNamespace>Microsoft.Android.Build.TypeMap.IntegrationTests</RootNamespace>
    <SignAssembly>true</SignAssembly>
    <AssemblyOriginatorKeyFile>..\..\product.snk</AssemblyOriginatorKeyFile>
    <!-- Use this assembly name to match InternalsVisibleTo in the pre-built Xamarin.Android.Build.Tasks.dll -->
    <AssemblyName>Xamarin.Android.Build.Tests</AssemblyName>
    <!-- Path to a fully-built android repo (sibling or same repo after `make prepare && make`).
         The test references pre-built DLLs from its test output directory. -->
    <AndroidRepoBinDir Condition=" '$(AndroidRepoBinDir)' == '' ">$(MSBuildThisFileDirectory)..\..\bin\TestDebug\net10.0</AndroidRepoBinDir>
    <AndroidRepoBinDirSibling>$(MSBuildThisFileDirectory)..\..\..\android\bin\TestDebug\net10.0</AndroidRepoBinDirSibling>
    <AndroidRepoBinDir Condition=" !Exists('$(AndroidRepoBinDir)\Xamarin.Android.Build.Tasks.dll') ">$(AndroidRepoBinDirSibling)</AndroidRepoBinDir>
  </PropertyGroup>

  <ItemGroup>
    <PackageReference Include="xunit" Version="2.9.3" />
    <PackageReference Include="xunit.runner.visualstudio" Version="3.0.2" />
    <PackageReference Include="Xunit.SkippableFact" Version="1.4.13" />
    <PackageReference Include="Microsoft.NET.Test.Sdk" Version="17.5.0" />
  </ItemGroup>

  <ItemGroup>
    <ProjectReference Include="..\..\src\Microsoft.Android.Build.TypeMap\Microsoft.Android.Build.TypeMap.csproj" />
  </ItemGroup>

  <!-- Reference pre-built legacy scanner DLLs -->
  <ItemGroup Condition=" Exists('$(AndroidRepoBinDir)\Xamarin.Android.Build.Tasks.dll') ">
    <Reference Include="Xamarin.Android.Build.Tasks">
      <HintPath>$(AndroidRepoBinDir)\Xamarin.Android.Build.Tasks.dll</HintPath>
      <Private>true</Private>
    </Reference>
    <Reference Include="Java.Interop.Tools.Cecil">
      <HintPath>$(AndroidRepoBinDir)\Java.Interop.Tools.Cecil.dll</HintPath>
      <Private>true</Private>
    </Reference>
    <Reference Include="Java.Interop.Tools.JavaCallableWrappers">
      <HintPath>$(AndroidRepoBinDir)\Java.Interop.Tools.JavaCallableWrappers.dll</HintPath>
      <Private>true</Private>
    </Reference>
    <Reference Include="Java.Interop.Tools.Diagnostics">
      <HintPath>$(AndroidRepoBinDir)\Java.Interop.Tools.Diagnostics.dll</HintPath>
      <Private>true</Private>
    </Reference>
    <Reference Include="Microsoft.Android.Build.BaseTasks">
      <HintPath>$(AndroidRepoBinDir)\Microsoft.Android.Build.BaseTasks.dll</HintPath>
      <Private>true</Private>
    </Reference>
    <Reference Include="Xamarin.Android.Tools.AndroidSdk">
      <HintPath>$(AndroidRepoBinDir)\Xamarin.Android.Tools.AndroidSdk.dll</HintPath>
      <Private>true</Private>
    </Reference>
    <Reference Include="Mono.Cecil">
      <HintPath>$(AndroidRepoBinDir)\Mono.Cecil.dll</HintPath>
      <Private>true</Private>
    </Reference>
    <Reference Include="Microsoft.Build.Framework">
      <HintPath>$(AndroidRepoBinDir)\Microsoft.Build.Framework.dll</HintPath>
      <Private>true</Private>
    </Reference>
    <Reference Include="Microsoft.Build.Utilities.Core">
      <HintPath>$(AndroidRepoBinDir)\Microsoft.Build.Utilities.Core.dll</HintPath>
      <Private>true</Private>
    </Reference>
  </ItemGroup>

</Project>
